/**
 * ZLDialog 1.4.5
 * Date: 2016-03-25
 * © 2013-2016 LangZhai(智能小菜菜)
 * This is licensed under the GNU LGPL, version 3 or later.
 * For details, see: http://www.gnu.org/licenses/lgpl.html
 * Project home: https://github.com/LangZhai/ZLDialog
 */
!function($){$.dialog=function(option){var $window=$(window),$body=$("body"),$ZLDialog,$dialogLock,$dialogTitleDIV,$dialogBody,$dialogFoot,$btn,timeout,interval,id=(new Date).getTime(),closeDialog=function(){var o=$ZLDialog.position(),i={left:o.left-($window.width()-$ZLDialog.width())/2,top:o.top-($window.height()-$ZLDialog.height())/2};clearTimeout(timeout),interval=setInterval(function(){$ZLDialog.css({left:($window.width()-$ZLDialog.width())/2+i.left,top:($window.height()-$ZLDialog.height())/2+i.top})},10),void 0!==$dialogLock&&$dialogLock.fadeOut(200).promise().done(function(){$dialogLock.remove()}),$ZLDialog.stop().hide(200).promise().done(function(){"function"===$.type(option.closeBack)&&option.closeBack(),clearInterval(interval),$ZLDialog.remove(),$window.off("resize.dialog"+id)})};return void 0==option&&(option={}),option.message?($ZLDialog=$("<div class='ZLDialog'><div class='dialogBody'></div></div>"),$dialogBody=$ZLDialog.children(".dialogBody")):($ZLDialog=$("<div class='ZLDialog'><div class='dialogTitleDIV'><div class='dialogTitleSpan'>"+(option.title||$.dialog.l18n.title)+"</div><a class='dialogTitleClose' title='"+$.dialog.l18n.close+"'>x</a></div><div class='dialogBody'></div><div class='dialogFoot'></div></div>"),$dialogTitleDIV=$ZLDialog.children(".dialogTitleDIV"),$dialogBody=$ZLDialog.children(".dialogBody"),$dialogFoot=$ZLDialog.children(".dialogFoot"),$dialogTitleDIV.on("click.dialog",".dialogTitleClose",closeDialog),option.hideX&&$dialogTitleDIV.children(".dialogTitleClose").remove(),void 0!==option.size&&("full"===option.size?($ZLDialog.width(9999),$dialogBody.height(9999)):($ZLDialog.width(option.size.width),$dialogBody.height(option.size.height))),(void 0===option.drag||option.drag)&&$dialogTitleDIV.on("mousedown.dialog",function(o){var i=$window.width()-$ZLDialog.outerWidth(),t=$window.height()-$ZLDialog.outerHeight(),e=$ZLDialog.position(),n={left:o.clientX,top:o.clientY};$body.off("mouseup.dialog").on("mouseup.dialog",function(){$body.off("mousemove.dialog")}).on("mousemove.dialog",function(o){var d=o.clientX-n.left+e.left,l=o.clientY-n.top+e.top;d=0>d?0:d>i?i:d,l=0>l?0:l>t?t:l,$ZLDialog.css({left:d,top:l})})})),void 0!==option.content&&($dialogBody.html(option.content),$("img",$dialogBody).each(function(){$(this).on("load.dialog",function(){$window.triggerHandler("resize.dialog"+id)})})),(void 0===option.lock||option.lock)&&($dialogLock=$("<div class='dialogLock'></div>").appendTo($body)),void 0!==option.padding&&("iframe"===option.padding?$dialogBody.css({padding:0,overflow:"hidden"}):$dialogBody.css({padding:option.padding})),"array"===$.type(option.buttons)&&$.each(option.buttons,function(i,btn){$btn=$("<a>"+btn.text+"</a>"),$dialogFoot.append($btn),void 0===btn.callback?$btn.on("click.dialog",closeDialog):"function"===$.type(btn.callback)?$btn.on("click.dialog",btn.callback):$btn.on("click.dialog",eval(btn.callback))}),$ZLDialog.appendTo($body).promise().done(function(){$window.on("resize.dialog"+id,function(){$dialogBody.css("max-height",$window.height()-50-(void 0===$dialogTitleDIV?0:$dialogTitleDIV.outerHeight(!0)+$dialogFoot.outerHeight(!0))),$ZLDialog.css("max-width",$window.width()-50).promise().done(function(){$ZLDialog.stop().animate({left:($window.width()-$ZLDialog.width())/2,top:($window.height()-$ZLDialog.height())/2},200)})}).triggerHandler("resize.dialog"+id),interval=setInterval(function(){$ZLDialog.css({left:($window.width()-$ZLDialog.width())/2,top:($window.height()-$ZLDialog.height())/2})},10),void 0!==$dialogLock&&$dialogLock.fadeTo(200,.3),$ZLDialog.stop().show(200).promise().done(function(){"function"===$.type(option.showBack)&&option.showBack(),"number"===$.type(option.timeout)&&(timeout=setTimeout(closeDialog,option.timeout)),setTimeout(function(){clearInterval(interval)},10)})}),closeDialog},$.dialog.message=function(o){return void 0==o&&(o={}),o.message=!0,o.title=void 0,o.hideX=void 0,o.buttons=void 0,o.size=void 0,o.drag=void 0,o.padding=void 0,void 0===o.timeout&&(o.timeout=2e3),void 0===o.lock&&(o.lock=!1),o.content="<span class='dialogMsgSpan'>"+o.content+"</span>",$.dialog(o)},$.dialog.alert=function(o){return void 0==o&&(o={}),o.message=void 0,void 0===o.title&&(o.title=$.dialog.l18n.alert),void 0===o.hideX&&(o.hideX=!0),o.buttons=[{text:$.dialog.l18n.ok}],o.content="<span class='dialogMsgSpan'>"+o.content+"</span>",$.dialog(o)},$.dialog.confirm=function(o,i,t){return void 0==o&&(o={}),o.message=void 0,void 0===o.title&&(o.title=$.dialog.l18n.confirm),void 0===o.content&&(o.content=$.dialog.l18n.confirmText),void 0===o.hideX&&(o.hideX=!0),o.buttons=[{text:$.dialog.l18n.yes,callback:i},{text:$.dialog.l18n.no,callback:t}],o.content="<span class='dialogMsgSpan'>"+o.content+"</span>",$.dialog(o)},$.dialog.open=function(o){return void 0==o&&(o={}),o.message=void 0,void 0===o.inFrame&&(o.inFrame=!1),o.inFrame?(o.content="<iframe frameborder='no' src='"+o.url+"' style='border:none;width:100%;height:100%'></iframe>",o.padding="iframe"):$.ajax({url:o.url,async:!1,dataType:"html"}).done(function(i){o.content=i}).fail(function(){o.content="<iframe frameborder='no' src='"+o.url+"' style='border:none;width:100%;height:100%'></iframe>",o.padding="iframe"}),$.dialog(o)},$.fn.dialog=function(o){return void 0==o&&(o={}),o.message=void 0,o.content=$(this).html(),$.dialog(o)},$.fn.preview=function(o){void 0==o&&(o={}),$(this).each(function(){var i,t=$(this),e=$("<div class='ZLDialog_panel'></div>"),n={};void 0===o.direction&&(o.direction="right"),void 0===o.padding&&(o.padding=10),void 0===o.timeout&&(o.timeout=500),void 0!==o.content&&("img"===o.type?(e.html(void 0===o.size?"<img src='"+o.content+"'>":"<img style='"+(o.size.width?"width:"+o.size.width+"px;":"")+(o.size.height?"height:"+o.size.height+"px;":"")+"' src='"+o.content+"'>"),o.padding=0):e.html(o.content)),"img"!==o.type&&void 0!==o.size&&(n.width=o.size.width,n.height=o.size.height),n.padding=o.padding,$.merge(t,e).on("mouseenter.dialog",function(){clearTimeout(i),e.data("loaded")||e.data("loaded",!0).appendTo($("body")).promise().done(function(){var i=t.offset();"top"===o.direction||"bottom"===o.direction?(n.left=i.left+(t.outerWidth(!0)-e.outerWidth(!0))/2,n.top="top"===o.direction?i.top-e.outerHeight(!0)-5:i.top+t.outerHeight(!0)+5):(n.top=i.top+(t.outerHeight(!0)-e.outerHeight(!0))/2,n.left="left"===o.direction?i.left-e.outerWidth(!0)-5:i.left+t.outerWidth(!0)+5),"img"===o.type&&(n.height=e.children().height()),e.hide().css(n)}),e.fadeIn().promise().done(function(){"function"===$.type(o.showBack)&&o.showBack()})}).on("mouseleave.dialog",function(){i=setTimeout(function(){e.fadeOut().promise().done(function(){"function"===$.type(o.closeBack)&&o.closeBack()})},o.timeout)})})},$.dialog.l18n={title:"对话框",alert:"提示",confirm:"确认",ok:"确定",yes:"确定",no:"取消",confirmText:"确定要执行这个操作吗？",close:"关闭"}}($);