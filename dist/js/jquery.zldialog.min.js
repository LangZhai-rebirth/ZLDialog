/**
 * ZLDialog 1.4.4
 * Date: 2016-03-23
 * © 2013-2016 LangZhai(智能小菜菜)
 * This is licensed under the GNU LGPL, version 3 or later.
 * For details, see: http://www.gnu.org/licenses/lgpl.html
 * Project home: https://github.com/LangZhai/ZLDialog
 */
!function($){$.dialog=function(option){var $window=$(window),$body=$("body"),$ZLDialog,$dialogLock,$dialogTitleDIV,$dialogBody,$dialogFoot,$btn,timeout,interval,id=(new Date).getTime(),closeDialog=function(){var o={left:$ZLDialog.offset().left-$window.scrollLeft()-($window.width()-$ZLDialog.width())/2,top:$ZLDialog.offset().top-$window.scrollTop()-($window.height()-$ZLDialog.height())/2};clearTimeout(timeout),interval=setInterval(function(){$ZLDialog.css({left:($window.width()-$ZLDialog.width())/2+o.left,top:($window.height()-$ZLDialog.height())/2+o.top})},10),$dialogLock&&$dialogLock.fadeOut(200).promise().done(function(){$dialogLock.remove()}),$ZLDialog.stop().hide(200).promise().done(function(){option.closeBack&&option.closeBack(),clearInterval(interval),$ZLDialog.remove(),$window.off("resize.dialog"+id)})};return void 0==option&&(option={}),option.message?($ZLDialog=$("<div class='ZLDialog'><div class='dialogBody'></div></div>"),$dialogBody=$ZLDialog.children(".dialogBody")):($ZLDialog=$("<div class='ZLDialog'><div class='dialogTitleDIV'><div class='dialogTitleSpan'>"+(option.title||$.dialog.l18n.title)+"</div><a class='dialogTitleClose' title='"+$.dialog.l18n.close+"'>x</a></div><div class='dialogBody'></div><div class='dialogFoot'></div></div>"),$dialogTitleDIV=$ZLDialog.children(".dialogTitleDIV"),$dialogBody=$ZLDialog.children(".dialogBody"),$dialogFoot=$ZLDialog.children(".dialogFoot"),$dialogTitleDIV.on("click.dialog",".dialogTitleClose",closeDialog),option.hideX&&$dialogTitleDIV.children(".dialogTitleClose").remove(),option.size&&($ZLDialog.width(option.size.width),$dialogBody.height(option.size.height),"full"===option.size?($ZLDialog.width(9999),$dialogBody.height(9999)):($ZLDialog.width(option.size.width),$dialogBody.height(option.size.height))),(void 0===option.drag||option.drag)&&$dialogTitleDIV.on("mousedown.dialog",function(o){var i=$window.width()-$ZLDialog.width(),t=$window.height()-$ZLDialog.height(),e=$ZLDialog.offset(),d={left:o.pageX,top:o.pageY},n={left:$window.scrollLeft(),top:$window.scrollTop()};$body.off("mouseup.dialog").on("mouseup.dialog",function(){$body.off("mousemove.dialog")}).on("mousemove.dialog",function(o){var l=o.pageX-d.left+e.left,a=o.pageY-d.top+e.top;l=l-n.left<0?n.left:l-n.left>i?i+n.left:l,a=a-n.top<0?n.top:a-n.top>t?t+n.top:a,$ZLDialog.offset({left:l,top:a})})})),option.content&&($dialogBody.html(option.content),$("img",$dialogBody).each(function(){$(this).on("load.dialog",function(){$window.triggerHandler("resize.dialog"+id)})})),(void 0===option.lock||option.lock)&&($dialogLock=$("<div class='dialogLock'></div>").appendTo($body)),option.padding&&("iframe"===option.padding?$dialogBody.css({padding:0,overflow:"hidden"}):$dialogBody.css({padding:option.padding})),option.buttons&&$.each(option.buttons,function(i,btn){$btn=$("<a>"+btn.text+"</a>"),$dialogFoot.append($btn),"function"===$.type(btn.callback)?$btn.on("click.dialog",btn.callback):btn.callback?$btn.on("click.dialog",eval(btn.callback)):$btn.on("click.dialog",closeDialog)}),$ZLDialog.appendTo($body).promise().done(function(){$window.on("resize.dialog"+id,function(){var o=$window.width()-50,i=$window.height()-50;$dialogTitleDIV?$dialogBody.css("max-height",i-$dialogTitleDIV.outerHeight(!0)-$dialogFoot.outerHeight(!0)):$dialogBody.css("max-height",i),$ZLDialog.css("max-width",o).promise().done(function(){$ZLDialog.stop().animate({left:($window.width()-$ZLDialog.width())/2,top:($window.height()-$ZLDialog.height())/2},200)})}).triggerHandler("resize.dialog"+id),interval=setInterval(function(){$ZLDialog.css({left:($window.width()-$ZLDialog.width())/2,top:($window.height()-$ZLDialog.height())/2})},10),$dialogLock&&$dialogLock.fadeTo(200,.3),$ZLDialog.stop().show(200).promise().done(function(){option.showBack&&option.showBack(),option.timeout&&(timeout=setTimeout(closeDialog,option.timeout)),setTimeout(function(){clearInterval(interval)},10)})}),closeDialog},$.dialog.message=function(o){return void 0==o&&(o={}),o.message=!0,o.title=void 0,o.hideX=void 0,o.buttons=void 0,o.size=void 0,o.drag=void 0,o.padding=void 0,void 0===o.timeout&&(o.timeout=2e3),void 0===o.lock&&(o.lock=!1),o.content="<span class='dialogMsgSpan'>"+o.content+"</span>",$.dialog(o)},$.dialog.alert=function(o){return void 0==o&&(o={}),o.message=void 0,void 0===o.title&&(o.title=$.dialog.l18n.alert),void 0===o.hideX&&(o.hideX=!0),o.buttons=[{text:$.dialog.l18n.ok}],o.content="<span class='dialogMsgSpan'>"+o.content+"</span>",$.dialog(o)},$.dialog.confirm=function(o,i,t){return void 0==o&&(o={}),o.message=void 0,void 0===o.title&&(o.title=$.dialog.l18n.confirm),void 0===o.content&&(o.content=$.dialog.l18n.confirmText),void 0===o.hideX&&(o.hideX=!0),o.buttons=[{text:$.dialog.l18n.yes,callback:i},{text:$.dialog.l18n.no,callback:t}],o.content="<span class='dialogMsgSpan'>"+o.content+"</span>",$.dialog(o)},$.dialog.open=function(o){return void 0==o&&(o={}),o.message=void 0,void 0===o.inFrame&&(o.inFrame=!1),o.inFrame?(o.content="<iframe frameborder='no' src='"+o.url+"' style='border:none;width:100%;height:100%'></iframe>",o.padding="iframe"):$.ajax({url:o.url,async:!1,dataType:"html"}).done(function(i){o.content=i}).fail(function(){o.content="<iframe frameborder='no' src='"+o.url+"' style='border:none;width:100%;height:100%'></iframe>",o.padding="iframe"}),$.dialog(o)},$.fn.dialog=function(o){return void 0==o&&(o={}),o.message=void 0,o.content=$(this).html(),$.dialog(o)},$.fn.preview=function(o){void 0==o&&(o={}),$(this).each(function(){var i,t=$(this),e=$("<div class='ZLDialog_panel'></div>");void 0===o.direction&&(o.direction="right"),void 0===o.padding&&(o.padding=10),void 0===o.timeout&&(o.timeout=500),o.content&&(o.type&&"img"===o.type?(o.size?e.html("<img style='"+(o.size.width?"max-width:"+o.size.width+"px;":"")+(o.size.height?"max-height:"+o.size.height+"px;":"")+"' src='"+o.content+"'>"):e.html("<img src='"+o.content+"'>"),o.padding=0):e.html(o.content)),"img"!==o.type&&o.size&&e.width(o.size.width).height(o.size.height),e.css({padding:o.padding}),$.merge(t,e).on("mouseenter.dialog",function(){clearTimeout(i),e.data("loaded")||e.data("loaded",!0).appendTo($("body")).css({position:"absolute"}).promise().done(function(){"top"===o.direction||"bottom"===o.direction?(e.offset({left:t.offset().left+(t.outerWidth(!0)-e.outerWidth(!0))/2}),"top"===o.direction?e.offset({top:t.offset().top-e.outerHeight(!0)-5}):e.offset({top:t.offset().top+t.outerHeight(!0)+5})):(e.offset({top:t.offset().top+(t.outerHeight(!0)-e.outerHeight(!0))/2}),"left"===o.direction?e.offset({left:t.offset().left-e.outerWidth(!0)-5}):e.offset({left:t.offset().left+t.outerWidth(!0)+5})),"img"===o.type&&e.height(e.children().height()),e.hide()}),e.fadeIn().promise().done(function(){o.showBack&&o.showBack()})}).on("mouseleave.dialog",function(){i=setTimeout(function(){e.fadeOut().promise().done(function(){o.closeBack&&o.closeBack()})},o.timeout)})})},$.dialog.l18n={title:"对话框",alert:"提示",confirm:"确认",ok:"确定",yes:"确定",no:"取消",confirmText:"确定要执行这个操作吗？",close:"关闭"}}($);